<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.62.2" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=VT323&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/4872e84fa1.js" crossorigin="anonymous"></script>

<script data-ad-client="ca-pub-4573306041548212" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title>How to Send Email in Golang&nbsp;&ndash;&nbsp;Shubham Chadokar</title><link rel="stylesheet" href="/css/core.min.f6c4e8d74298ad5ec80382828077e919496093f45533660642b5cb1bbd0d68540d80b48d1ef3c389a8ddf5ffc661dee7.css" integrity="sha384-9sTo10KYrV7IA4KCgHfpGUlgk/RVM2YGQrXLG70NaFQNgLSNHvPDiajd9f/GYd7n">

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="How to Send Email in Golang" /><meta name="twitter:image" content="https://schadokar.dev/images/sendinblue/go-sendinblue-cover.png" /><body><section id="header">
    <div class="container">        
        <nav class="navbar navbar-expand-md navbar-light site-nav">

            <a class="navbar-brand site home" href="/"><span class="site name">Shubham Chadokar</span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarsExample04"><div class="nav wrap ml-auto">




    
<nav class="nav">
    <ul class="navbar-nav "><li class="nav-item">
        <a class="nav item nav-link" href="/to-the-point">To-The-Point</a>
        </li><li class="nav-item">
        <a class="nav item nav-link" href="https://github%2ecom/schadokar/resume/blob/main/ShubhamChadokar_Resume%2epdf"target="_blank">Resume</a>
        </li></ul>
    
</nav>
</div></div>
        </nav>
    </div>
    
</section>

    <section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">How to Send Email in Golang</h1><p class="article date">Thursday, June 11, 2020<span class="reading-time"> ‚Ä¢ 5 minutes to read</span></p><section class="article labels"><a class="category" href=/categories/golang/>Golang</a><a class="category" href=/categories/tutorial/>Tutorial</a><a class="category" href=/categories/2020/>2020</a><a class="tag" href=/tags/golang/>golang</a><a class="tag" href=/tags/sendemail/>sendemail</a><a class="tag" href=/tags/sendinblue/>sendinblue</a></section>
</section>
<article class="article markdown-body">
        
        
        <p>This is a series of tutorials: sending email in golang.
We'll first start with the basic sending an email using the <code>go</code> command.</p>
<p>In the upcoming tutorials, we will create an API and a frontend using which we will send emails.</p>
<p>In this tutorial, we will send an email using the <code>main.go</code> file.</p>
<h1 id="pre-requisites">Pre-requisites</h1>
<ol>
<li>go v1.11 or greater - I am using go1.14.3</li>
<li>Code Editor (VSCode, Atom) - I am using VS Code</li>
<li>Sendinblue account - <a href="https://www.sendinblue.com/?tap_a=30591-fb13f0&amp;tap_s=956728-d372bc"target="_blank">link</a></li>
</ol>
<blockquote>
<p>Check out this step by step tutorial <a href="https://schadokar.dev/to-the-point/create-an-account-in-sendinblue/"target="_blank">Create an account in sendinblue</a>.</p>
</blockquote>
<h1 id="getting-started">Getting Started</h1>
<p>Create a new directory <code>go-sendinblue</code>.</p>
<p>Open the terminal inside the directory and run the below command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">go</span> mod init <span style="color:#ff79c6">go</span><span style="color:#ff79c6">-</span>sendinblue
</code></pre></div><p>This command will initiate a module <code>go.mod</code>.<br>
A module is a collection of dependency modules used in the project. This will list all the dependencies with their version in the <code>go.mod</code> file.</p>
<h2 id="add-the-dependency">Add the Dependency</h2>
<p>In this project, we are going to use the environment variables from the <code>.env</code> file. To access the <code>.env</code> file and use it we have to add a dependency <code>godotenv</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">go</span> get github.com<span style="color:#ff79c6">/</span>joho<span style="color:#ff79c6">/</span>godotenv
</code></pre></div><p>This package is simple and clean.<br>
Learn more about <a href="https://schadokar.dev/posts/use-environment-variable-in-your-next-golang-project/"target="_blank">how to use environment variables in the golang</a>.</p>
<h2 id="create-a-new-smtp-key">Create a new SMTP Key</h2>
<p>Sign in to your Sendinblue account and click on SMTP &amp; API from the top-right menu.</p>
<p>Go to <strong>SMTP</strong> tab and click on <em>CREATE A NEW SMTP KEY</em>.<br>
Copy the key and paste it somewhere safe.</p>
<blockquote>
<p>‚ö†Ô∏è Note: If you lose this key, then you can't retrieve it. Then you have to create a new one and replace it accordingly.</p>
</blockquote>
<h2 id="environment-variable">Environment Variable</h2>
<p>Create a new <code>.env</code> file inside the <code>go-sendinblue</code> project.<br>
Open the file and enter the following keys and values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">PASSWORD<span style="color:#ff79c6">=</span>Enter your Sendinblue SMTP Key
SMTP_HOST<span style="color:#ff79c6">=</span>smtp<span style="color:#ff79c6">-</span>relay.sendinblue.com
SMTP_PORT<span style="color:#ff79c6">=</span><span style="color:#bd93f9">587</span>
</code></pre></div><p>Verify the <code>SMTP_HOST</code> and <code>SMTP_PORT</code> from the <strong>SMTP &amp; API</strong> section of your account.</p>
<blockquote>
<p>‚ö†Ô∏è Caution: If you're using git then don't forget to add <code>.env</code> in the <code>.gitignore</code> file. This will prevent your secrets to access by anyone.</p>
</blockquote>
<h2 id="coding-time-">Coding Time üë®‚Äçüíª</h2>
<p>Create a new <code>main.go</code> inside the <code>go-sendinblue</code> project.<br>
Open the <code>main.go</code> file and paste the below code.
We are going to use <code>smtp</code> package provided by golang.</p>
<blockquote>
<p>Package smtp implements the Simple Mail Transfer Protocol as defined in RFC 5321.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">package</span> main

<span style="color:#ff79c6">import</span> (
    <span style="color:#f1fa8c">&#34;fmt&#34;</span>
    <span style="color:#f1fa8c">&#34;log&#34;</span>
    <span style="color:#f1fa8c">&#34;net/smtp&#34;</span>
    <span style="color:#f1fa8c">&#34;os&#34;</span>

    <span style="color:#6272a4">// Import godotenv
</span><span style="color:#6272a4"></span>    <span style="color:#f1fa8c">&#34;github.com/joho/godotenv&#34;</span>
)

<span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
    <span style="color:#6272a4">// From address
</span><span style="color:#6272a4"></span>    from <span style="color:#ff79c6">:=</span> <span style="color:#f1fa8c">&#34;hello@schadokar.dev&#34;</span>

    <span style="color:#6272a4">// Array of recipients address
</span><span style="color:#6272a4"></span>    to <span style="color:#ff79c6">:=</span> []<span style="color:#8be9fd">string</span>{<span style="color:#f1fa8c">&#34;shubham@schadokar.dev&#34;</span>}

    <span style="color:#6272a4">// Create a message and convert it into bytes
</span><span style="color:#6272a4"></span>    msg <span style="color:#ff79c6">:=</span> []<span style="color:#8be9fd;font-style:italic">byte</span>(<span style="color:#f1fa8c">&#34;To: shubham@schadokar.dev\r\n&#34;</span> <span style="color:#ff79c6">+</span>
        <span style="color:#f1fa8c">&#34;From: hello@schadokar.dev\r\n&#34;</span> <span style="color:#ff79c6">+</span>
        <span style="color:#f1fa8c">&#34;Subject: Hello Gophers!\r\n&#34;</span> <span style="color:#ff79c6">+</span>
        <span style="color:#f1fa8c">&#34;\r\n&#34;</span> <span style="color:#ff79c6">+</span>
        <span style="color:#f1fa8c">&#34;This is the email is sent using golang and sendinblue.\r\n&#34;</span>)

    <span style="color:#6272a4">// Call the sendEmail function
</span><span style="color:#6272a4"></span>    status <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">sendEmail</span>(from, to, msg)

    <span style="color:#6272a4">// check if email sent successfully or not
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span> status {
        fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;Email sent successfully.&#34;</span>)
    } <span style="color:#ff79c6">else</span> {
        fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;Email sent failed.&#34;</span>)
    }
}

<span style="color:#6272a4">// send mail function
</span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">sendEmail</span>(from <span style="color:#8be9fd">string</span>, to []<span style="color:#8be9fd">string</span>, msg []<span style="color:#8be9fd">byte</span>) <span style="color:#8be9fd">bool</span> {
    <span style="color:#6272a4">// Load .env file to use the environment variable
</span><span style="color:#6272a4"></span>    err <span style="color:#ff79c6">:=</span> godotenv.<span style="color:#50fa7b">Load</span>(<span style="color:#f1fa8c">&#34;.env&#34;</span>)

    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
        log.<span style="color:#50fa7b">Fatalf</span>(<span style="color:#f1fa8c">&#34;Error loading .env file&#34;</span>)
    }

    <span style="color:#6272a4">// Set up authentication information.
</span><span style="color:#6272a4"></span>    auth <span style="color:#ff79c6">:=</span> smtp.<span style="color:#50fa7b">PlainAuth</span>(<span style="color:#f1fa8c">&#34;&#34;</span>, from, os.<span style="color:#50fa7b">Getenv</span>(<span style="color:#f1fa8c">&#34;PASSWORD&#34;</span>), os.<span style="color:#50fa7b">Getenv</span>(<span style="color:#f1fa8c">&#34;SMTP_HOST&#34;</span>))

    <span style="color:#6272a4">// format smtp address
</span><span style="color:#6272a4"></span>    smtpAddress <span style="color:#ff79c6">:=</span> fmt.<span style="color:#50fa7b">Sprintf</span>(<span style="color:#f1fa8c">&#34;%s:%v&#34;</span>, os.<span style="color:#50fa7b">Getenv</span>(<span style="color:#f1fa8c">&#34;SMTP_HOST&#34;</span>), os.<span style="color:#50fa7b">Getenv</span>(<span style="color:#f1fa8c">&#34;SMTP_PORT&#34;</span>))

    <span style="color:#6272a4">// Connect to the server, authenticate, set the sender and recipient,
</span><span style="color:#6272a4"></span>    <span style="color:#6272a4">// and send the email all in one step.
</span><span style="color:#6272a4"></span>    err = smtp.<span style="color:#50fa7b">SendMail</span>(smtpAddress, auth, from, to, msg)

    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
        log.<span style="color:#50fa7b">Fatal</span>(err)
        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span>
    }

    <span style="color:#6272a4">// return true on success
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">true</span>
}
</code></pre></div><p>Let's understand the code piece by piece.</p>
<p>In the <code>main</code> function we're first declaring the <strong>from</strong>, <strong>to</strong>, and <strong>msg</strong>.<br>
<strong>from</strong> is the address from which you created the sendinblue account.
<strong>to</strong> is an array of string.<br>
<strong>msg</strong> is an array of bytes.</p>
<blockquote>
<p>‚ö†Ô∏è You must define the <strong>From</strong> field in the msg. It is not mentioned in the smtp package documentation. Maybe it is only required for sendinblue. I have not tested with other mail service providers.</p>
</blockquote>
<p>In the <code>sendEmail</code> function, it is taking <strong>from</strong>, <strong>to</strong>, and <strong>msg</strong> as arguments and returning a <code>bool</code> status.</p>
<p>In the import, we have imported the <code>github.com/joho/godotenv</code> package to load the <code>.env</code> file. To load the <code>.env</code> file, use <code>Load</code> method of <code>godoenv</code>.
From the <code>.env</code> file, we will load <strong>PASSWORD</strong>, <strong>SMTP_HOST</strong> and <strong>SMTP_PORT</strong>.</p>
<p>The <code>smtp</code> package has 2 methods to authenticate the mail server. <a href="https://golang.org/pkg/net/smtp/#Auth"target="_blank">Read more</a><br>
We're going to use the <code>PlainAuth</code> method.</p>
<h4 id="syntax">Syntax</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">PlainAuth</span>(identity, username, password, host <span style="color:#8be9fd">string</span>) Auth
</code></pre></div><blockquote>
<p>PlainAuth returns an Auth that implements the PLAIN authentication mechanism as defined in RFC 4616. The returned Auth uses the given username and password to authenticate to host and act as identity. Usually, identity should be the empty string, to act as username.</p>
</blockquote>
<blockquote>
<p>PlainAuth will only send the credentials if the connection is using TLS or is connected to localhost. Otherwise, authentication will fail with an error, without sending the credentials.</p>
</blockquote>
<p>Now, as the <code>.env</code> is loaded by the <code>godotenv</code> package. We can use <code>os</code> package to read the environment variables.</p>
<p>Format an SMTP Address.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">smtp-relay.sendinblue.com:<span style="color:#bd93f9">587</span>
</code></pre></div><p>Use <code>os</code> package to read <strong>PASSWORD</strong>, <strong>SMTP_HOST</strong> and <strong>SMTP_PORT</strong>.</p>
<p>Using the <code>SendMail</code> method of <code>smtp</code> package, it can connect to the server, authenticate and send the email the message to all the recipients by the sender.</p>
<h2 id="send-the-email">Send the email</h2>
<p>Open the project in the terminal and run the below command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#ff79c6">go</span> run main.<span style="color:#ff79c6">go</span>
</code></pre></div><p>Check your mailbox. You have received a mail. If you could not find the mail check in the promotion.</p>
<p><img  src="https://schadokar.dev/images/sendinblue/mail-sent-sendinblue.PNG"
        alt="sent-mail"/></p>
<p>The <code>smtp</code> package does not provide enough information of delivery of the mail. It only confirms if mail sent to server or not.</p>
<p>From server side, there can be many reasons if it is delivered or not. To check if sent successfully or not.<br>
Open the sendinblue account and click on the <strong>Transactional</strong> tab.</p>
<p>In this tab, you can check the status of the mail.
The common reason can be an incorrect mail address. For this it raise a <strong>Hard bounce</strong> event.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Hope, you find this tutorial helpful. The complete code is available on my <a href="https://github.com/schadokar/go-sendmail"target="_blank">GitHub</a> repository.</p>
<p>In the upcoming tutorials, we are going to create API and a frontend.</p>
<hr>
</article><section class="article labels"><a class="category" href=/categories/golang/>Golang</a><a class="category" href=/categories/tutorial/>Tutorial</a><a class="category" href=/categories/2020/>2020</a><a class="tag" href=/tags/golang/>golang</a><a class="tag" href=/tags/sendemail/>sendemail</a><a class="tag" href=/tags/sendinblue/>sendinblue</a></section></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/create-a-color-cli-in-golang/"><span class="">Previous</span>Create a Color Cli in Golang</a></p><p><a class="link" href="/posts/create-a-to-do-app-in-reactjs-with-github-pages/"><span class="">Next</span>Create a To Do App in Reactjs with Github Pages</a></p></section></div></section>
<section id="footer">
    <div class="footer wrap mt-5">
        <div class="container">
            <div class="nav wrap mb-3">
                <nav class="nav w-100 d-flex text-center align-items-center justify-content-center">
                  <a class="nav item" href="/to-the-point">To-The-Point</a>
                  <a class="nav item" href="/projects">Projects</a>
                  <a class="nav item" href="/ebooks">Ebook</a>
                  <a class="nav item" href="/about">About</a>
                  <a class="nav item" href="https://github.com/schadokar/resume/blob/main/ShubhamChadokar_Resume.pdf" target="_blank">Resume</a>
                </nav>
            </div>
        </div>
        <div class="footer flex justify-center social-icon">
                
                    <a href="https://github.com/schadokar" class="navbar-item is-hidden-desktop" title="GitHub">
                        <span
                            class="icon"><i class='fab fa-github'></i>
                        </span>
                    </a>
                
                    <a href="https://medium.com/@schadokar" class="navbar-item is-hidden-desktop" title="Medium">
                        <span
                            class="icon"><i class='fab fa-medium'></i>
                        </span>
                    </a>
                
                    <a href="https://twitter.com/schadokar1" class="navbar-item is-hidden-desktop" title="Twitter">
                        <span
                            class="icon"><i class='fab fa-twitter'></i>
                        </span>
                    </a>
                <div class="footer-wrap">
    <p class="copyright">&copy; <a href="https://schadokar.dev">Shubham Chadokar</a> 2020</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io"
        target="_blank">Hugo</a><span>
    </p>
</div>
</div>
        <span class="footer right-side d-none"><div class="nav wrap ml-auto">




    
<nav class="nav">
    <ul class="navbar-nav "><li class="nav-item">
                <a class="nav item nav-link" href="/categories/">Categories</a>
            </li><li class="nav-item">
            <a class="nav item nav-link" href="/tags/">Tags</a>
        </li><li class="nav-item">
        <a class="nav item nav-link" href="/newsletter">Newsletter</a>
        </li><li class="nav-item">
        <a class="nav item nav-link" href="/contact">Contact</a>
        </li></ul>
    
</nav>
</div></span>
        
    </div>
</section>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-158088106-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous"></script>
<script src="https://schadokar.dev/js/search.js"></script></body>

</html>