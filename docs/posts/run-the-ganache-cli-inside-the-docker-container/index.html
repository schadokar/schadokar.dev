<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.62.2" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<script src="https://kit.fontawesome.com/4872e84fa1.js" crossorigin="anonymous"></script><title>Run the Ganache Cli Inside the Docker Container&nbsp;&ndash;&nbsp;Shubham Chadokar</title><link rel="stylesheet" href="/css/core.min.d6952daf9b9e1416674c325169c3a71ceb436c5f824d6ee2013146d3b7206ca6152d067fa14aadb42755d718bc2fdd29.css" integrity="sha384-1pUtr5ueFBZnTDJRacOnHOtDbF&#43;CTW7iATFG07cgbKYVLQZ/oUqttCdV1xi8L90p"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Run the Ganache Cli Inside the Docker Container" />
<meta name="twitter:image" content="" />
<body><section id="header">
    <div class="header wrap">
        <span class="header left-side">
            <a class="site home" href="/"><span class="site name">Shubham Chadokar</span>
            </a>
        </span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/posts">Posts</a><a class="nav item" href="/to-the-point">To-The-Point</a><a class="nav item" href="/projects">Projects</a><a class="nav item" href="/ebooks">Ebook</a><a class="nav item" href="/about">About</a></nav></div></span>
    </div>
    
</section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Run the Ganache Cli Inside the Docker Container</h1><p class="article date">Monday, April 1, 2019<span class="reading-time"> • 4 minutes to read</span></p></section><article class="article markdown-body"><p><img  src="https://cdn-images-1.medium.com/max/1800/1*xDXuvZWGToFqqPKEBcwksg.png"
        alt/></p>
<p>In this article, we’ll run the <code>ganache-cli</code> inside the docker container and
then we will connect it to the <a href="https://metamask.io/"target="_blank">Metamask</a> and transfer some Ether from one account to another.</p>
<p><strong>Prerequisites:</strong></p>
<ol>
<li>Docker installed in your machine. Please check out this
<a href="https://www.docker.com/get-started"target="_blank">link</a> and install which fits with your OS.</li>
<li>The Metamask plugin installed to your browser. Please check out this <a href="https://metamask.io/"target="_blank">link</a> and follow the instructions to install it.</li>
</ol>
<p>Lets first create the project directory by name <code>docker-ganache</code>.</p>
<p>Inside the <code>docker-ganache</code>, create a file named <code>Dockerfile</code>.</p>
<p>The <code>Dockerfile</code> doesn’t require a file extension and <strong>D</strong> must be uppercase.</p>
<p>Our file structure will look like this</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">- docker-ganache
  - Dockerfile
</code></pre></div><p><code>Dockerfile</code> is the file where we’ll define all the commands required to create a <code>ganache-cli</code> docker image.</p>
<blockquote>
<p>Docker can build images automatically by reading the instructions from a <code>Dockerfile</code>.</p>
</blockquote>
<hr>
<p>Open the Dockerfile in any editor and paste the below code</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-docker" data-lang="docker"><span style="color:#75715e"># node:alpine will be our base image to create this image</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> node:alpine</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Set the /app directory as working directory</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /app</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Install ganache-cli globally</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> npm install -g ganache-cli<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Set the default command for the image</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;ganache-cli&#34;</span>, <span style="color:#e6db74">&#34;-h&#34;</span>, <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Let’s take a dip into the code and explore what it is actually doing.</p>
<p>The Docker container requires Node.js installed in it to install the
<code>ganache-cli</code>.</p>
<p>The <code>node:alpine</code> is the base image in which the latest Node.js is
pre-installed.</p>
<blockquote>
<p><em>What does alpine means?</em></p>
</blockquote>
<p>It is the minimum requirement needed for Node.js. It includes the required
libraries. For more information please visit this <a href="https://derickbailey.com/2017/03/09/selecting-a-node-js-image-for-docker/"target="_blank">link</a>.</p>
<p>The base image already has a filesystem for <code>node:alpine</code></p>
<pre><code>app    dev    home   media  opt    root   sbin   sys    usr
bin    etc    lib    mnt    proc   run    srv    tmp    var
</code></pre>
<p>The second step <code>WORKDIR /app</code> we are instructing the Dockerfile to use <code>/app</code> folder as the working directory for this image</p>
<p>The third step <code>RUN npm install -g ganache-cli</code> installs the <code>ganache-cli</code>
globally.</p>
<p>The last step <code>CMD [&quot;ganache-cli&quot;,&quot;-h&quot;,&quot;0.0.0.0&quot;]</code></p>
<p>When this image run there must be a default command for this or else you have to manually tell what it should do.</p>
<p><code>ganache-cli -h 0.0.0.0</code> is the default command for this image. When this image run it will run this default command.</p>
<blockquote>
<p>Ganache-cli’s default host is 127.0.0.1 but for docker instance it is 0.0.0.0</p>
</blockquote>
<p>Please refer to this <a href="https://hub.docker.com/r/trufflesuite/ganache-cli/"target="_blank">link</a>.
for more information on <code>ganache-cli</code> flags like <code>-h</code></p>
<hr>
<p>Lets now build the image. Open the terminal or CLI and make sure you’re in the docker-ganache directory</p>
<p>Run the below command to build the Dockerfile</p>
<pre><code>docker build .
</code></pre>
<p>Thanks to <a href="https://medium.com/u/32dec75e8ca9"target="_blank">KC Tam</a> for suggesting to use the tag in docker build command.</p>
<pre><code>docker build -t ganache .
</code></pre>
<p>You can use tags for the image as image name instead of using an image ID like <code>7726b19a7bff</code> .</p>
<p>To learn more about image tags please visit this <a href="https://docs.docker.com/engine/reference/commandline/build/"target="_blank">link</a>.</p>
<p>The first time it runs, it might take some time. After it completes, you will
likely see the output similar to the image below.</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*6cI8NKpVxeZfRDLDv4LhbQ.png"
        alt/></p>
<p>Your output might be slightly different than this. In my case, I have tested it
a couple of times previously so everything was saved in the cache memory.</p>
<p>Check the output carefully.</p>
<pre><code>Successfully built 7726b19a7bff
</code></pre>
<p>This is the image ID of Dockerfile what we just built. Great all the setup is
done, now let’s test it.</p>
<hr>
<p>Run the docker image and start a container</p>
<pre><code>docker run -p 8545:8545 7726b19a7bff
</code></pre>
<p>Or</p>
<pre><code>docker run -p 8545:8545 ganache
</code></pre>
<p>In my case <code>7726b19a7bff</code> is the image ID. You should run your matching ID or the image tag <code>ganache</code>.</p>
<blockquote>
<p>What is -p 8545:8545 doing here?</p>
</blockquote>
<p>When ganache-cli run on 8545 port, this port is not exposed out of the
container. To access this <code>-p 8545:8545</code> flag expose the 8545 port on 8545 port.</p>
<p>To explain it further, take this example:</p>
<p>Whenever any request points to port 3000, it will redirect the request to
container’s 8545 port. It is not compulsory that the other port number has to be the same as the container.</p>
<blockquote>
<p><code>--publish , -p </code>Publish a container’s port(s) to the host</p>
</blockquote>
<p>For more information please refer to this <a href="https://docs.docker.com/engine/reference/commandline/run/"target="_blank">link</a>.</p>
<p>After running the command you’ll see the output like this</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*SpnZ8LOC0sYZoF3UAZkfMA.png"
        alt/></p>
<p>If you see output like this then you’re on right path.</p>
<hr>
<p>Let’s connect our <code>ganache-cli</code> to Metamask. Open your browser and Metamask and select the <strong>Localhost 8545</strong> network.</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*fIkn_gha8BWay-SzYZ8XGw.png"
        alt/></p>
<p>Metamask it now connected to <code>docker-ganache</code>.</p>
<p>Let’s import one account to the Metamask. Copy the private key of an account from the running ganache instance.</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*HjhJ4xYMgocxbN4pW-TXlQ.png"
        alt/></p>
<p>From Metamask menu click on “Import Account”.</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*C5EfaJAD7fH1jLTPd2zSNA.png"
        alt/></p>
<p>Paste the private key and import. After importing you will see 100 ETH in the
account.</p>
<p><img  src="https://cdn-images-1.medium.com/max/1200/1*Hou3-ya383e8i1J85IxSSw.png"
        alt/></p>
<p>Let’s send some ether to another account</p>
<ul>
<li>Click on <strong>Send</strong></li>
<li>Select <strong>Account 1</strong> in To field</li>
<li>Enter <strong>10</strong> in the <strong>Amount</strong> field</li>
<li>Select <strong>Next</strong> and <strong>Confirm</strong></li>
</ul>
<p>Once the transaction is confirmed, check the Account 1 and Account 2.</p>
<p><strong>Account 2</strong> is <strong>89.9998</strong> something. The additional missing ETH is the fee paid for the transaction.</p>
<h3 id="conclusion">Conclusion</h3>
<p>You successfully connected to the <code>ganache-cli</code> running inside the Docker container and
submitted a transaction using the Metamask.</p>
<hr>
</article><section class="article labels"><a class="category" href=/categories/tutorial/>Tutorial</a><a class="category" href=/categories/2019/>2019</a><a class="category" href=/categories/blockchain/>Blockchain</a><a class="tag" href=/tags/tutorial/>tutorial</a><a class="tag" href=/tags/blockchain/>blockchain</a><a class="tag" href=/tags/ganache/>ganache</a><a class="tag" href=/tags/ethereum/>ethereum</a></section></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/posts/create-an-ethereum-dapp-with-react-and-docker/"><span class="li iconfont icon-article"></span>Create an Ethereum Dapp with React and Docker</a></p><p><a class="link" href="/posts/deploy-angular-application-on-azure-web-service/"><span class="li iconfont icon-article"></span>Deploy Angular application on Azure Web Service</a></p></section><section class="article discussion"><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "schadokar" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></section></div></section>
<section id="footer">
    <div class="footer wrap">
        <span class="footer">
                
                    <a href="https://github.com/schadokar" class="navbar-item is-hidden-desktop" title="GitHub">
                        <span
                            class="icon"><i class='fab fa-github'></i>
                        </span>
                    </a>
                
                    <a href="https://medium.com/@schadokar" class="navbar-item is-hidden-desktop" title="Medium">
                        <span
                            class="icon"><i class='fab fa-medium'></i>
                        </span>
                    </a>
                
                    <a href="https://twitter.com/schadokar1" class="navbar-item is-hidden-desktop" title="Twitter">
                        <span
                            class="icon"><i class='fab fa-twitter'></i>
                        </span>
                    </a>
                <div class="footer-wrap">
    <p class="copyright">&copy; <a href="https://schadokar.dev">Shubham Chadokar</a> 2020</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></span>
        <span class="footer right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/newsletter">Newsletter</a><a class="nav item" href="/contact">Contact</a></nav></div></span>
    </div>
</section>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-158088106-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</body>

</html>